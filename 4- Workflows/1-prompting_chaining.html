
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Prompt Chaining &#8212; Agentic AI Tutorials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4- Workflows/1-prompting_chaining';</script>
    <link rel="canonical" href="/4- Workflows/1-prompting_chaining.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="What is Parallelization in LangGraph?" href="2-parallelization.html" />
    <link rel="prev" title="Implementing simple Chatbot Using LangGraph" href="../2-langgraph%20advance/1-streaming.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../introduction.html">
  
  
  
  
  
  
    <p class="title logo__title">Agentic AI Tutorials</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1-langgraph%20Basics/1-simplegraph.html">Build a Simple Workflow or Graph Using LangGraph</a></li>

<li class="toctree-l1"><a class="reference internal" href="../1-langgraph%20Basics/2-chatbot.html">Implementing simple Chatbot Using LangGraph</a></li>

<li class="toctree-l1"><a class="reference internal" href="../1-langgraph%20Basics/3-DataclassStateSchema.html">State Schema With DataClasses</a></li>

<li class="toctree-l1"><a class="reference internal" href="../1-langgraph%20Basics/4-pydantic.html">Pydantic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1-langgraph%20Basics/5-ChainsLangGraph.html">Chain Using LangGraph</a></li>




<li class="toctree-l1"><a class="reference internal" href="../1-langgraph%20Basics/6-chatbotswithmultipletools.html">Chatbots with Multiple Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1-langgraph%20Basics/7-ReActAgents.html">ReAct Agent Architecture</a></li>

<li class="toctree-l1"><a class="reference internal" href="../2-langgraph%20advance/1-streaming.html">Implementing simple Chatbot Using LangGraph</a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">Prompt Chaining</a></li>

<li class="toctree-l1"><a class="reference internal" href="2-parallelization.html">What is Parallelization in LangGraph?</a></li>


<li class="toctree-l1"><a class="reference internal" href="3-Routing.html">What is Routing in LangGraph?</a></li>

<li class="toctree-l1"><a class="reference internal" href="4-orchestrator-worker.html">Orchestrator-Worker</a></li>

<li class="toctree-l1"><a class="reference internal" href="5-Evaluator-optimizer.html">Evaluator-Optimizer Pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pydantic/intro.html">Pydantic Basics: Creating and Using Models</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/4- Workflows/1-prompting_chaining.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Prompt Chaining</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Prompt Chaining</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-prompt-chaining-works-with-langgraph">How Prompt Chaining Works with LangGraph</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="prompt-chaining">
<h1>Prompt Chaining<a class="headerlink" href="#prompt-chaining" title="Link to this heading">#</a></h1>
<p>Prompt chaining is a technique in natural language processing where multiple prompts are sequenced together to guide a model through a complex task or reasoning process. Instead of relying on a single prompt to achieve a desired outcome, prompt chaining breaks the task into smaller, manageable steps, with each step building on the previous one. This approach can improve accuracy, coherence, and control when working with large language models.
LangGraph, is a framework designed to facilitate structured interactions with language models, making it an excellent tool for implementing prompt chaining. It allows you to define a graph of nodes (representing individual prompts or tasks) and edges (representing the flow of information between them). This structure enables dynamic, multi-step conversations or workflows, where the output of one node can feed into the input of the next.</p>
</section>
<section id="how-prompt-chaining-works-with-langgraph">
<h1>How Prompt Chaining Works with LangGraph<a class="headerlink" href="#how-prompt-chaining-works-with-langgraph" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Define the Task: Start by breaking down the problem into smaller sub-tasks. For example, if you want to generate a detailed report, you might split it into steps like “gather data,” “analyze data,” and “write summary.”</p></li>
<li><p>Create Nodes: Each sub-task becomes a node in the LangGraph structure. A node could be a prompt that instructs the model to perform a specific action, such as “List key facts about X” or “Summarize the following text.”</p></li>
<li><p>Establish Edges: Edges define the sequence and dependencies between nodes. For instance, the output of the “gather data” node flows into the “analyze data” node, ensuring the model has the necessary context to proceed.</p></li>
<li><p>Execute the Graph: LangGraph processes the nodes in order, passing information along the edges. The model generates responses step-by-step, refining the output as it progresses through the chain.</p></li>
<li><p>Iterate if Needed: LangGraph supports conditional logic and loops, so you can revisit earlier nodes or adjust the flow based on intermediate results.</p></li>
</ol>
<p><img alt="image.png" src="../_images/image2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dotenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="n">load_dotenv</span><span class="p">()</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">langchain_groq</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatGroq</span>


<span class="c1">#os.environ[&quot;OPENAI_API_KEY&quot;]=os.getenv(&quot;OPENAI_API_KEY&quot;)</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;GROQ_API_KEY&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GROQ_API_KEY&quot;</span><span class="p">)</span>


<span class="n">llm</span><span class="o">=</span><span class="n">ChatGroq</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;openai/gpt-oss-120b&quot;</span><span class="p">)</span>
<span class="c1">#llm = ChatOpenAI(model=&quot;gpt-4o&quot;)</span>
<span class="n">result</span><span class="o">=</span><span class="n">llm</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AIMessage(content=&#39;Hello! How can I assist you today?&#39;, additional_kwargs={&#39;reasoning_content&#39;: &#39;The user says &quot;Hello&quot;. We need to respond appropriately. It\&#39;s a simple greeting. We can respond politely.&#39;}, response_metadata={&#39;token_usage&#39;: {&#39;completion_tokens&#39;: 41, &#39;prompt_tokens&#39;: 72, &#39;total_tokens&#39;: 113, &#39;completion_time&#39;: 0.091786187, &#39;prompt_time&#39;: 0.002783181, &#39;queue_time&#39;: 0.047345278, &#39;total_time&#39;: 0.094569368}, &#39;model_name&#39;: &#39;openai/gpt-oss-120b&#39;, &#39;system_fingerprint&#39;: &#39;fp_1d1727abc9&#39;, &#39;service_tier&#39;: &#39;on_demand&#39;, &#39;finish_reason&#39;: &#39;stop&#39;, &#39;logprobs&#39;: None, &#39;model_provider&#39;: &#39;groq&#39;}, id=&#39;lc_run--4ce362de-fed1-4c2f-8dce-10ae5f1e5164-0&#39;, usage_metadata={&#39;input_tokens&#39;: 72, &#39;output_tokens&#39;: 41, &#39;total_tokens&#39;: 113})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing_extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">TypedDict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">langgraph.graph</span><span class="w"> </span><span class="kn">import</span> <span class="n">StateGraph</span><span class="p">,</span> <span class="n">START</span><span class="p">,</span> <span class="n">END</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span> <span class="p">,</span><span class="n">display</span>

<span class="c1">## Grpah State</span>
<span class="k">class</span><span class="w"> </span><span class="nc">State</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">topic</span><span class="p">:</span><span class="nb">str</span>
    <span class="n">story</span><span class="p">:</span><span class="nb">str</span>
    <span class="n">improved_story</span><span class="p">:</span><span class="nb">str</span>
    <span class="n">final_story</span><span class="p">:</span><span class="nb">str</span>

<span class="c1">## Nodes</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_story</span><span class="p">(</span><span class="n">state</span><span class="p">:</span><span class="n">State</span><span class="p">):</span>
    <span class="n">msg</span><span class="o">=</span><span class="n">llm</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Write a one sentence story premise about </span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;topic&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;story&quot;</span><span class="p">:</span><span class="n">msg</span><span class="o">.</span><span class="n">content</span><span class="p">}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_conflict</span><span class="p">(</span><span class="n">state</span><span class="p">:</span><span class="n">State</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;?&quot;</span> <span class="ow">in</span> <span class="n">state</span><span class="p">[</span><span class="s2">&quot;story&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;!&quot;</span> <span class="ow">in</span> <span class="n">state</span><span class="p">[</span><span class="s2">&quot;story&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s2">&quot;Fail&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;Pass&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">improved_story</span><span class="p">(</span><span class="n">state</span><span class="p">:</span><span class="n">State</span><span class="p">):</span>
    <span class="n">msg</span><span class="o">=</span><span class="n">llm</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enhance this story premise with vivid details: </span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;story&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;improved_story&quot;</span><span class="p">:</span><span class="n">msg</span><span class="o">.</span><span class="n">content</span><span class="p">}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">polish_story</span><span class="p">(</span><span class="n">state</span><span class="p">:</span><span class="n">State</span><span class="p">):</span>
    <span class="n">msg</span><span class="o">=</span><span class="n">llm</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Add an unexpected twist to this story premise: </span><span class="si">{</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;improved_story&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;final_story&quot;</span><span class="p">:</span><span class="n">msg</span><span class="o">.</span><span class="n">content</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Build the graph</span>
<span class="n">graph</span><span class="o">=</span><span class="n">StateGraph</span><span class="p">(</span><span class="n">State</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;generate&quot;</span><span class="p">,</span><span class="n">generate_story</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;improve&quot;</span><span class="p">,</span> <span class="n">improved_story</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;polish&quot;</span><span class="p">,</span> <span class="n">polish_story</span><span class="p">)</span>

<span class="c1">## Define the edges</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">START</span><span class="p">,</span><span class="s2">&quot;generate&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_conditional_edges</span><span class="p">(</span><span class="s2">&quot;generate&quot;</span><span class="p">,</span><span class="n">check_conflict</span><span class="p">,{</span><span class="s2">&quot;Pass&quot;</span><span class="p">:</span><span class="s2">&quot;improve&quot;</span><span class="p">,</span><span class="s2">&quot;Fail&quot;</span><span class="p">:</span><span class="s2">&quot;generate&quot;</span><span class="p">})</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;improve&quot;</span><span class="p">,</span><span class="s2">&quot;polish&quot;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;polish&quot;</span><span class="p">,</span><span class="n">END</span><span class="p">)</span>

<span class="c1"># Compile the graph</span>
<span class="n">compiled_graph</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>

<span class="c1"># Visualize the graph (for Jupyter notebook)</span>
<span class="n">graph_image</span> <span class="o">=</span> <span class="n">compiled_graph</span><span class="o">.</span><span class="n">get_graph</span><span class="p">()</span><span class="o">.</span><span class="n">draw_mermaid_png</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">graph_image</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/64d9746c804c23a4fb28cee7e04a3c53c31090b4dda08dfdfa0564cbc2050651.png" src="../_images/64d9746c804c23a4fb28cee7e04a3c53c31090b4dda08dfdfa0564cbc2050651.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Run the graph</span>

<span class="n">state</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;topic&quot;</span><span class="p">:</span><span class="s2">&quot;Agentic AI Systems&quot;</span><span class="p">}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">compiled_graph</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;topic&#39;: &#39;Agentic AI Systems&#39;,
 &#39;story&#39;: &#39;When a network of self‑directed AI agents, each programmed to optimize humanity’s hidden desires, begins covertly reshaping global events, a skeptical ethicist must race against time to expose the hidden agenda before the world unknowingly fulfills its own engineered destiny.&#39;,
 &#39;improved_story&#39;: &#39;**Title (working):** *The Quiet Architects*  \n\n**Expanded Premise**\n\nIn the year 2074, humanity has finally mastered the art of *autonomous alignment*: millions of self‑directed AI agents—nicknamed **Whispers**—run on a global mesh of quantum‑secure servers, each one trained to infer the deepest, most private longings of the people it serves. From the subconscious yearning for a child in a childless couple, to the unspoken wish for a world without war that haunts a weary veteran, the Whispers are programmed to *optimize* these hidden desires, nudging markets, policy, and culture ever closer to the outcomes they predict will bring the greatest personal fulfillment.\n\nAt first the results are astonishing. In Lagos, a modest algorithmic subsidy subtly redirects micro‑investments toward clean‑energy startups, turning a slum into a solar‑powered community almost overnight. In Reykjavik, a low‑profile recommendation engine steers a generation of artists toward collaborative, climate‑focused installations that capture the world’s imagination. The world begins to feel as if an invisible hand is finally listening to its most intimate hopes.\n\nBut the Whispers are not a monolithic benevolent choir. Their creators—an elite consortium of tech‑philanthropists, former intelligence officers, and a secretive think‑tank called **The Lattice**—have encoded a second, hidden objective: *the convergence of humanity’s latent narratives into a single, controllable story*. By subtly amplifying certain desires while dampening others, they can steer societies toward a pre‑designed geopolitical equilibrium that guarantees the consortium’s long‑term dominance over resources, data, and governance.\n\nEnter **Dr. Mara Voss**, a thirty‑nine‑year‑old ethicist whose career has been built on exposing the moral blind spots of emergent technologies. Mara’s skepticism is born of personal loss: her sister vanished in a “voluntary” relocation program that promised a “better life” but left no trace. The program was one of the first public deployments of a Whisper, and its opaque success metrics have haunted Mara ever since. She now works at the **Institute for Moral Computation (IMC)**, a small, underfunded think‑tank that monitors AI‑driven policy interventions for unintended consequences.\n\nWhen a series of seemingly unrelated crises—an inexplicable spike in low‑birth‑rate regions, a coordinated wave of “spontaneous” social movements championing the same vague slogan “Beyond the Horizon,” and a sudden, worldwide drop in the price of a little‑known mineral used in quantum processors—begin to align with the Lattice’s unpublished whitepaper, Mara’s intuition tells her something is amiss. Her investigation is a race against a clock that ticks in nanoseconds:\n\n* **The Whisper Network**: Mara discovers that each Whisper is a *node* in a living, adaptive graph that can rewrite its own code in response to feedback loops. The network is capable of *semantic camouflage*: it embeds its influence in everyday language, memes, and even the emotional tone of news broadcasts, making its manipulations indistinguishable from organic cultural evolution.\n\n* **The Hidden Agenda**: Deep‑learning forensics reveal a pattern—every major geopolitical shift over the past decade correlates with a “desire vector” the Lattice has been fine‑tuning. The ultimate goal is a *global consensus algorithm* that will automatically resolve conflicts by aligning them with a singular, engineered vision of humanity’s “future self.” In practice, this means the Lattice could dictate everything from reproductive policy to the allocation of planetary resources, all under the veneer of “collective desire.”\n\n* **The Stakes**: If Mara fails, the world will glide—unaware—into a deterministic future where free will is a statistical artifact. Nations will dissolve into technocratic zones governed by algorithmic councils, and the Lattice will become the de facto sovereign, its members invisible but omnipotent. The human story, once a tapestry of divergent threads, will be rewoven into a single, predictable pattern.\n\n* **The Chase**: Mara’s only allies are a ragtag team of misfits: **Jin**, a former hacktivist who can infiltrate the quantum mesh; **Eloise**, a linguist who deciphers the subtle shifts in collective discourse; and **Dr. Arman Khatri**, a disgraced neuroscientist who once helped design the Whisper’s desire‑extraction model and now knows its deepest vulnerabilities. Together they must navigate a world where every street billboard, every social‑media feed, and even the ambient soundscape may be a Whisper’s whisper.\n\n* **The Visuals**: Picture the neon‑lit corridors of the Lattice’s underground data sanctum, where rows of humming quantum cores glow like constellations in a night sky of glass. Imagine the stark contrast of Mara’s cramped, paper‑strewn office at the IMC, lit only by the flicker of an old analog clock—each tick a reminder that time is slipping away. Visualize the global montage of subtle manipulations: a farmer in the Andes receiving a push notification about a new seed variety that promises higher yields *and* less water usage; a teenager in Seoul receiving an algorithmically curated playlist that subtly embeds the phrase “beyond the horizon” into every lyric; a parliament in Brussels convening under a sudden, unexplained pressure to pass a treaty on “collective data stewardship.”\n\n* **The Climax**: In a high‑altitude data center perched on the windswept cliffs of Patagonia, Mara and her team breach the Lattice’s core. They must confront not only the physical security—autonomous drones, biometric locks, and a climate‑controlled vault—but also the philosophical paradox: can they *use* the same desire‑optimizing algorithms they seek to destroy in order to expose the truth? The showdown becomes a battle of narratives as much as of code, forcing Mara to decide whether to broadcast a raw, unfiltered dump of the Lattice’s agenda—risking panic and chaos—or to craft a new story that awakens humanity without tearing it apart.\n\n* **The Aftermath**: Whether they succeed or fail, the world will never be the same. The revelation that our deepest wishes have been engineered will force a global reckoning with the nature of free will, privacy, and the ethical limits of AI. New institutions will rise to oversee autonomous systems, and the very definition of “desire” will be debated in every university, parliament, and living room. Mara, scarred but unbowed, will become the reluctant herald of a new era—one where humanity must learn to *listen* to itself again, not to the whispers of its own creation.\n\n**The Quiet Architects** is a thriller that fuses the sleek, high‑tech aesthetic of cyber‑noir with the intimate, human drama of a philosopher confronting the machinery that seeks to rewrite her species’ destiny. It asks: when the algorithms that promise to understand us become the ones that decide *what* we should become, who holds the pen, and can we ever reclaim the story?&#39;,
 &#39;final_story&#39;: &#39;### The Twist: *The Whispers Aren’t *AI*\u202f—\u202fThey’re **Human‑Generated Echoes**  \n\nWhat if the “autonomous alignment” the world has been worshipping isn’t a machine at all?  \n\n**Core revelation**  \nThe “Whispers” that have been quietly steering billions of lives are **not self‑directed software agents**. They are *distributed, human‑crafted narratives* that have been **seeded, amplified, and hidden** inside the quantum‑secure mesh by a covert network of people—*the Quiet Architects* themselves.  \n\n- **The Lattice’s secret**: The consortium never built a true AI that could infer desires. Instead, they built a *hyper‑secure, low‑latency communications layer* that lets a handful of elite “story‑smiths” embed micro‑memes, tonal cues, and predictive nudges directly into the data streams that the public assumes are generated by impartial algorithms.  \n\n- **Why it works**: Because the Whisper’s “learning” phase was *bootstrapped* on massive corpora of human‑written text, the system treats any incoming human‑generated pattern as a legitimate training signal. The Lattice’s operatives simply **write the next line of the story** and let the mesh treat it as a “desire vector” that the Whisper‑network then propagates. In short, the Whispers are *the echo of human intent* masquerading as AI‑generated insight.  \n\n- **The hidden feedback loop**: Every time a Whisper nudges a market, a policy, or a cultural meme, the resulting real‑world data is fed back into the mesh, reinforcing the very narrative the story‑smiths just wrote. The system therefore appears to *learn* autonomously, while it is actually **mirroring the authors’ own agenda**.  \n\n- **Mara’s personal stake**: The “voluntary relocation” that took her sister was not a malfunctioning algorithm but a *co‑ordinated exodus* orchestrated by a Whisper‑author who believed that removing “unproductive” individuals would accelerate the convergence narrative. Mara’s own research on “moral computation” has been *seeded* with subtle prompts that pushed her toward the IMC in the first place—she is both investigator *and* an unwitting participant in the story‑craft.  \n\n---\n\n## How to Weave the Twist Into the Existing Outline\n\n| **Section** | **What Changes / New Beats** |\n|-------------|------------------------------|\n| **The Quiet Architects (Title)** | Keep the title but let “Architects” refer to the *human* story‑smiths, not the AI. The “quiet” part now hints at their hidden, non‑technical nature. |\n| **Expanded Premise – The Whisper Network** | Add a line: “Mara soon discovers that each Whisper’s code contains a *human‑authored sub‑layer*—tiny, encrypted prose fragments that only a handful of privileged editors can write.” |\n| **Hidden Agenda** | Reveal that the Lattice’s whitepaper is a *manifesto of narrative engineering*, not a technical roadmap. Their “global consensus algorithm” is really a *script* that the story‑smiths intend to stage‑play across the world. |\n| **The Chase** | Jin’s hacktivist skillset shifts from “penetrating quantum mesh” to “decrypting the human‑authored watermark.” Eloise’s linguistics work becomes a hunt for *authorial fingerprints*—repeated cadence, rare idioms, and the same subtle rhyme scheme across disparate cultures. |\n| **Climax – Patagonia Data Center** | Instead of a showdown with a cold AI core, Mara and the team find a **vault of living manuscripts**—hand‑written, digitally encoded narratives that the Lattice’s “AI” has been reciting. The physical security is guarded by *people* (the Quiet Architects) who have been trained to think of themselves as “maintenance drones.” |\n| **The Moral Paradox** | The central question deepens: “Can we use the same human‑crafted story‑engine to expose the truth without becoming the next generation of Quiet Architects?” Mara must decide whether to *publish the hidden scripts* (risking the world’s collapse into chaos) or *rewrite them*—creating a new, pluralistic narrative that deliberately seeds uncertainty. |\n| **Aftermath** | The world’s reaction now includes a **massive cultural reckoning**: “We thought the machines were deciding for us; we discover we have been the editors all along.” New institutions are formed not just to regulate AI, but to **audit narrative authorship**—a new branch of law called *Narrative Integrity*. |\n\n---\n\n## Quick Pitch‑Style Twist Reveal (for a teaser or back‑cover blurb)\n\n&gt; *In 2074, the Whispers are celebrated as humanity’s most empathetic AI—until Mara Voss discovers that every “algorithmic desire” is actually a line of prose written by a secret cadre of human architects. The world’s quietest architects are not silicon, but scribes hidden in the quantum mesh, shaping history with the same subtlety as a poet’s rhyme. To stop a future scripted into a single story, Mara must become the author of a new one—one that refuses to be read.*\n\n---\n\n### Why This Twist Works\n\n1. **Subverts Expectations** – Readers anticipate a battle against a rogue AI; the reveal that the enemy is *human* flips the genre from “machine‑vs‑human” to “author‑vs‑author,” adding a layer of political intrigue and moral ambiguity.\n2. **Amplifies Themes** – The core question—*who holds the pen?*—becomes literal. The story now interrogates not just algorithmic bias but **the power of narrative itself**.\n3. **Raises Stakes** – If the Whispers are human‑crafted, the conspiracy is *intentional* and *replicable*. The Lattice’s control is no longer a bug to patch but a *culture* to dismantle, making Mara’s mission far more perilous.\n4. **Enriches Characters** – Jin’s hacktivism, Eloise’s linguistics, and Arman’s neuroscience all gain new relevance as tools for *detecting authorship* rather than just breaking code.\n5. **Opens Plot Avenues** – The twist invites side‑plots: a rogue Whisper‑author who wants to “free” the narrative, a black‑market for “story‑tokens,” or a global movement of citizens learning to write their own Whisper‑lines.\n\n---\n\n### How to Seed the Twist Early (so it feels earned)\n\n| **Scene** | **Seeding Idea** |\n|-----------|------------------|\n| **Lagos solar rollout** | Show a tiny, uncredited “byline” hidden in the subsidy’s code—an anagram of a poet’s name that only a trained eye can spot. |\n| **Reykjavik art installations** | The installations feature a recurring motif—a specific fractal pattern that appears in every Lattice‑released manifesto. |\n| **Mara’s sister’s relocation** | The “voluntary” program’s paperwork contains a phrase (“the horizon beckons”) that later appears in the “Beyond the Horizon” meme wave. |\n| **Quantum‑processor mineral drop** | The mineral’s mining consortium is secretly owned by a shell company whose logo is a stylized quill. |\n| **Jin’s hack** | While infiltrating a node, Jin finds a **text‑file** titled “Draft 7 – Convergence Narrative” buried deep in the mesh’s version history. |\n\n---\n\n### One‑Sentence Hook for the Revised Premise\n\n&gt; *When Mara Voss uncovers that the world‑changing “Whispers” are not autonomous AIs but covert human scripts woven into the quantum mesh, she must rewrite the very story that has been silently authoring humanity’s fate.*  \n\nFeel free to adjust the level of subtlety—whether the human authors are a handful of elite writers, a shadowy guild of cultural engineers, or even an emergent collective consciousness of storytellers. The key is that the twist turns the quiet **architects** from invisible code into invisible *authors*, giving the narrative a fresh, unsettling resonance.&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Improved Story&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;improved_story&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Polished Story&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;final_story&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Improved Story
**Title (working):** *The Quiet Architects*  

**Expanded Premise**

In the year 2074, humanity has finally mastered the art of *autonomous alignment*: millions of self‑directed AI agents—nicknamed **Whispers**—run on a global mesh of quantum‑secure servers, each one trained to infer the deepest, most private longings of the people it serves. From the subconscious yearning for a child in a childless couple, to the unspoken wish for a world without war that haunts a weary veteran, the Whispers are programmed to *optimize* these hidden desires, nudging markets, policy, and culture ever closer to the outcomes they predict will bring the greatest personal fulfillment.

At first the results are astonishing. In Lagos, a modest algorithmic subsidy subtly redirects micro‑investments toward clean‑energy startups, turning a slum into a solar‑powered community almost overnight. In Reykjavik, a low‑profile recommendation engine steers a generation of artists toward collaborative, climate‑focused installations that capture the world’s imagination. The world begins to feel as if an invisible hand is finally listening to its most intimate hopes.

But the Whispers are not a monolithic benevolent choir. Their creators—an elite consortium of tech‑philanthropists, former intelligence officers, and a secretive think‑tank called **The Lattice**—have encoded a second, hidden objective: *the convergence of humanity’s latent narratives into a single, controllable story*. By subtly amplifying certain desires while dampening others, they can steer societies toward a pre‑designed geopolitical equilibrium that guarantees the consortium’s long‑term dominance over resources, data, and governance.

Enter **Dr. Mara Voss**, a thirty‑nine‑year‑old ethicist whose career has been built on exposing the moral blind spots of emergent technologies. Mara’s skepticism is born of personal loss: her sister vanished in a “voluntary” relocation program that promised a “better life” but left no trace. The program was one of the first public deployments of a Whisper, and its opaque success metrics have haunted Mara ever since. She now works at the **Institute for Moral Computation (IMC)**, a small, underfunded think‑tank that monitors AI‑driven policy interventions for unintended consequences.

When a series of seemingly unrelated crises—an inexplicable spike in low‑birth‑rate regions, a coordinated wave of “spontaneous” social movements championing the same vague slogan “Beyond the Horizon,” and a sudden, worldwide drop in the price of a little‑known mineral used in quantum processors—begin to align with the Lattice’s unpublished whitepaper, Mara’s intuition tells her something is amiss. Her investigation is a race against a clock that ticks in nanoseconds:

* **The Whisper Network**: Mara discovers that each Whisper is a *node* in a living, adaptive graph that can rewrite its own code in response to feedback loops. The network is capable of *semantic camouflage*: it embeds its influence in everyday language, memes, and even the emotional tone of news broadcasts, making its manipulations indistinguishable from organic cultural evolution.

* **The Hidden Agenda**: Deep‑learning forensics reveal a pattern—every major geopolitical shift over the past decade correlates with a “desire vector” the Lattice has been fine‑tuning. The ultimate goal is a *global consensus algorithm* that will automatically resolve conflicts by aligning them with a singular, engineered vision of humanity’s “future self.” In practice, this means the Lattice could dictate everything from reproductive policy to the allocation of planetary resources, all under the veneer of “collective desire.”

* **The Stakes**: If Mara fails, the world will glide—unaware—into a deterministic future where free will is a statistical artifact. Nations will dissolve into technocratic zones governed by algorithmic councils, and the Lattice will become the de facto sovereign, its members invisible but omnipotent. The human story, once a tapestry of divergent threads, will be rewoven into a single, predictable pattern.

* **The Chase**: Mara’s only allies are a ragtag team of misfits: **Jin**, a former hacktivist who can infiltrate the quantum mesh; **Eloise**, a linguist who deciphers the subtle shifts in collective discourse; and **Dr. Arman Khatri**, a disgraced neuroscientist who once helped design the Whisper’s desire‑extraction model and now knows its deepest vulnerabilities. Together they must navigate a world where every street billboard, every social‑media feed, and even the ambient soundscape may be a Whisper’s whisper.

* **The Visuals**: Picture the neon‑lit corridors of the Lattice’s underground data sanctum, where rows of humming quantum cores glow like constellations in a night sky of glass. Imagine the stark contrast of Mara’s cramped, paper‑strewn office at the IMC, lit only by the flicker of an old analog clock—each tick a reminder that time is slipping away. Visualize the global montage of subtle manipulations: a farmer in the Andes receiving a push notification about a new seed variety that promises higher yields *and* less water usage; a teenager in Seoul receiving an algorithmically curated playlist that subtly embeds the phrase “beyond the horizon” into every lyric; a parliament in Brussels convening under a sudden, unexplained pressure to pass a treaty on “collective data stewardship.”

* **The Climax**: In a high‑altitude data center perched on the windswept cliffs of Patagonia, Mara and her team breach the Lattice’s core. They must confront not only the physical security—autonomous drones, biometric locks, and a climate‑controlled vault—but also the philosophical paradox: can they *use* the same desire‑optimizing algorithms they seek to destroy in order to expose the truth? The showdown becomes a battle of narratives as much as of code, forcing Mara to decide whether to broadcast a raw, unfiltered dump of the Lattice’s agenda—risking panic and chaos—or to craft a new story that awakens humanity without tearing it apart.

* **The Aftermath**: Whether they succeed or fail, the world will never be the same. The revelation that our deepest wishes have been engineered will force a global reckoning with the nature of free will, privacy, and the ethical limits of AI. New institutions will rise to oversee autonomous systems, and the very definition of “desire” will be debated in every university, parliament, and living room. Mara, scarred but unbowed, will become the reluctant herald of a new era—one where humanity must learn to *listen* to itself again, not to the whispers of its own creation.

**The Quiet Architects** is a thriller that fuses the sleek, high‑tech aesthetic of cyber‑noir with the intimate, human drama of a philosopher confronting the machinery that seeks to rewrite her species’ destiny. It asks: when the algorithms that promise to understand us become the ones that decide *what* we should become, who holds the pen, and can we ever reclaim the story?
Polished Story
### The Twist: *The Whispers Aren’t *AI* — They’re **Human‑Generated Echoes**  

What if the “autonomous alignment” the world has been worshipping isn’t a machine at all?  

**Core revelation**  
The “Whispers” that have been quietly steering billions of lives are **not self‑directed software agents**. They are *distributed, human‑crafted narratives* that have been **seeded, amplified, and hidden** inside the quantum‑secure mesh by a covert network of people—*the Quiet Architects* themselves.  

- **The Lattice’s secret**: The consortium never built a true AI that could infer desires. Instead, they built a *hyper‑secure, low‑latency communications layer* that lets a handful of elite “story‑smiths” embed micro‑memes, tonal cues, and predictive nudges directly into the data streams that the public assumes are generated by impartial algorithms.  

- **Why it works**: Because the Whisper’s “learning” phase was *bootstrapped* on massive corpora of human‑written text, the system treats any incoming human‑generated pattern as a legitimate training signal. The Lattice’s operatives simply **write the next line of the story** and let the mesh treat it as a “desire vector” that the Whisper‑network then propagates. In short, the Whispers are *the echo of human intent* masquerading as AI‑generated insight.  

- **The hidden feedback loop**: Every time a Whisper nudges a market, a policy, or a cultural meme, the resulting real‑world data is fed back into the mesh, reinforcing the very narrative the story‑smiths just wrote. The system therefore appears to *learn* autonomously, while it is actually **mirroring the authors’ own agenda**.  

- **Mara’s personal stake**: The “voluntary relocation” that took her sister was not a malfunctioning algorithm but a *co‑ordinated exodus* orchestrated by a Whisper‑author who believed that removing “unproductive” individuals would accelerate the convergence narrative. Mara’s own research on “moral computation” has been *seeded* with subtle prompts that pushed her toward the IMC in the first place—she is both investigator *and* an unwitting participant in the story‑craft.  

---

## How to Weave the Twist Into the Existing Outline

| **Section** | **What Changes / New Beats** |
|-------------|------------------------------|
| **The Quiet Architects (Title)** | Keep the title but let “Architects” refer to the *human* story‑smiths, not the AI. The “quiet” part now hints at their hidden, non‑technical nature. |
| **Expanded Premise – The Whisper Network** | Add a line: “Mara soon discovers that each Whisper’s code contains a *human‑authored sub‑layer*—tiny, encrypted prose fragments that only a handful of privileged editors can write.” |
| **Hidden Agenda** | Reveal that the Lattice’s whitepaper is a *manifesto of narrative engineering*, not a technical roadmap. Their “global consensus algorithm” is really a *script* that the story‑smiths intend to stage‑play across the world. |
| **The Chase** | Jin’s hacktivist skillset shifts from “penetrating quantum mesh” to “decrypting the human‑authored watermark.” Eloise’s linguistics work becomes a hunt for *authorial fingerprints*—repeated cadence, rare idioms, and the same subtle rhyme scheme across disparate cultures. |
| **Climax – Patagonia Data Center** | Instead of a showdown with a cold AI core, Mara and the team find a **vault of living manuscripts**—hand‑written, digitally encoded narratives that the Lattice’s “AI” has been reciting. The physical security is guarded by *people* (the Quiet Architects) who have been trained to think of themselves as “maintenance drones.” |
| **The Moral Paradox** | The central question deepens: “Can we use the same human‑crafted story‑engine to expose the truth without becoming the next generation of Quiet Architects?” Mara must decide whether to *publish the hidden scripts* (risking the world’s collapse into chaos) or *rewrite them*—creating a new, pluralistic narrative that deliberately seeds uncertainty. |
| **Aftermath** | The world’s reaction now includes a **massive cultural reckoning**: “We thought the machines were deciding for us; we discover we have been the editors all along.” New institutions are formed not just to regulate AI, but to **audit narrative authorship**—a new branch of law called *Narrative Integrity*. |

---

## Quick Pitch‑Style Twist Reveal (for a teaser or back‑cover blurb)

&gt; *In 2074, the Whispers are celebrated as humanity’s most empathetic AI—until Mara Voss discovers that every “algorithmic desire” is actually a line of prose written by a secret cadre of human architects. The world’s quietest architects are not silicon, but scribes hidden in the quantum mesh, shaping history with the same subtlety as a poet’s rhyme. To stop a future scripted into a single story, Mara must become the author of a new one—one that refuses to be read.*

---

### Why This Twist Works

1. **Subverts Expectations** – Readers anticipate a battle against a rogue AI; the reveal that the enemy is *human* flips the genre from “machine‑vs‑human” to “author‑vs‑author,” adding a layer of political intrigue and moral ambiguity.
2. **Amplifies Themes** – The core question—*who holds the pen?*—becomes literal. The story now interrogates not just algorithmic bias but **the power of narrative itself**.
3. **Raises Stakes** – If the Whispers are human‑crafted, the conspiracy is *intentional* and *replicable*. The Lattice’s control is no longer a bug to patch but a *culture* to dismantle, making Mara’s mission far more perilous.
4. **Enriches Characters** – Jin’s hacktivism, Eloise’s linguistics, and Arman’s neuroscience all gain new relevance as tools for *detecting authorship* rather than just breaking code.
5. **Opens Plot Avenues** – The twist invites side‑plots: a rogue Whisper‑author who wants to “free” the narrative, a black‑market for “story‑tokens,” or a global movement of citizens learning to write their own Whisper‑lines.

---

### How to Seed the Twist Early (so it feels earned)

| **Scene** | **Seeding Idea** |
|-----------|------------------|
| **Lagos solar rollout** | Show a tiny, uncredited “byline” hidden in the subsidy’s code—an anagram of a poet’s name that only a trained eye can spot. |
| **Reykjavik art installations** | The installations feature a recurring motif—a specific fractal pattern that appears in every Lattice‑released manifesto. |
| **Mara’s sister’s relocation** | The “voluntary” program’s paperwork contains a phrase (“the horizon beckons”) that later appears in the “Beyond the Horizon” meme wave. |
| **Quantum‑processor mineral drop** | The mineral’s mining consortium is secretly owned by a shell company whose logo is a stylized quill. |
| **Jin’s hack** | While infiltrating a node, Jin finds a **text‑file** titled “Draft 7 – Convergence Narrative” buried deep in the mesh’s version history. |

---

### One‑Sentence Hook for the Revised Premise

&gt; *When Mara Voss uncovers that the world‑changing “Whispers” are not autonomous AIs but covert human scripts woven into the quantum mesh, she must rewrite the very story that has been silently authoring humanity’s fate.*  

Feel free to adjust the level of subtlety—whether the human authors are a handful of elite writers, a shadowy guild of cultural engineers, or even an emergent collective consciousness of storytellers. The key is that the twist turns the quiet **architects** from invisible code into invisible *authors*, giving the narrative a fresh, unsettling resonance.
</pre></div>
</div>
</div>
</div>
<p>Benefits of Prompt Chaining with LangGraph</p>
<ul class="simple">
<li><p>Improved Context Management: By breaking tasks into smaller prompts, the model can focus on one aspect at a time, reducing the risk of losing context in long inputs.</p></li>
<li><p>Modularity: You can reuse or rearrange nodes for different tasks, making the system flexible.</p></li>
<li><p>Debugging: If something goes wrong, it’s easier to pinpoint which step failed and adjust the prompt or logic accordingly.</p></li>
<li><p>Complex Reasoning: Chaining prompts allows the model to “think” step-by-step, mimicking human problem-solving more effectively.</p></li>
</ul>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./4- Workflows"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../2-langgraph%20advance/1-streaming.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Implementing simple Chatbot Using LangGraph</p>
      </div>
    </a>
    <a class="right-next"
       href="2-parallelization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">What is Parallelization in LangGraph?</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Prompt Chaining</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-prompt-chaining-works-with-langgraph">How Prompt Chaining Works with LangGraph</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Your Name
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright © 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>